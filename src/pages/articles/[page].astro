---
import ArticleCard from "../../components/ArticleCard.astro";
import MainLayout from "../../layouts/MainLayout.astro";
import type { GetStaticPaths } from "astro";
import Pagination from "../../components/Pagination.astro";
import TagCloud from "../../components/TagCloud.astro";
import { fetchArticles } from "../../js/utils";

export const getStaticPaths = (async ({ paginate }) => {
  const articles = await fetchArticles();

  const pages = paginate(articles, { pageSize: 2 });
  return pages;
}) satisfies GetStaticPaths;

const { page } = Astro.props;
// console.log("ðŸš€ ~ page:", {...page, data: null});

const title = "Articles";
const subtitle = `Page ${page.currentPage} of ${page.lastPage}`;
---

<MainLayout title=`${title} - ${subtitle}`>
  <hgroup>
    <h1 id="page-title">{title}</h1>
    <p>{subtitle}</p>
  </hgroup>

  <ul class="card-stack" role="list" aria-labelledby="page-title">
    {page.data.map((article, index) => <ArticleCard {article} {index} {page} hLevel="h3" />)}
  </ul>

  <Pagination {page} />

  <TagCloud />
</MainLayout>

<style lang="scss">
  hgroup {
    margin-bottom: 2rem;
  }
</style>
