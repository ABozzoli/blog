---
import { Icon } from "astro-icon/components";
import type { HTMLAttributes } from "astro/types";

interface Props extends HTMLAttributes<"details"> {
  title: string;
}

const { title, ...props } = Astro.props;
---

<details {...props}>
  <summary>{title}<Icon name="mdi:chevron-down" size="2rem" /></summary>
  <slot />
</details>

<style lang="scss">
  summary {
    display: flex; /* Anything but "list-item" will remove the ::marker */
    align-items: center;
    justify-content: space-between;
    column-gap: 16px;
    padding: 16px;
    cursor: pointer;
    transition:
      background-color 0.3s ease,
      color 0.3s ease;
  }

  details {
    outline: 1px solid var(--foreground); /* Used this instead of border to keep it visible within the focus indicator */
    outline-offset: -1px;
    background-color: var(--background);
  }

  details + details {
    margin-top: -1px; /* To collapse the borders between two details */
  }

  details summary:hover {
    text-decoration-line: underline;
  }

  details[open] summary {
    background-color: color-mix(in srgb, var(--foreground) 5%, var(--background));
  }

  details summary svg {
    flex-shrink: 0; /* Prevent the icon from shrinking when there's a lot of text */
    margin: -0.5rem; /* Compensate for whitespace around the icon */
    transition: rotate 0.3s ease;
  }

  details[open] summary svg {
    rotate: -180deg;
  }
</style>
