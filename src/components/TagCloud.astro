---
import { fetchArticles, slugify } from "../js/utils";

const articles = await fetchArticles();

const tags = articles.map((article) => article.data.category).sort();

// prettier-ignore
const tagsCount = tags.reduce((acc, category) => {
  acc[category] = (acc[category] ?? 0) + 1;
  return acc;
}, {} as Record<string, number>);
---

{
  Object.keys(tagsCount).length > 0 && (
    <aside>
      <h2 id="tag-cloud-title" class="text-center mt-48">
        Categories
      </h2>
      <ul class="tag-cloud" role="list" aria-labelledby="tag-cloud-title">
        {Object.entries(tagsCount).map(([tag, count]) => (
          <li>
            <a class="badge" href={`category/${slugify(tag)}`}>
              {tag} ({count})
            </a>
          </li>
        ))}
      </ul>
    </aside>
  )
}
